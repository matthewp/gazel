/*[global-shim]*/
!function(exports,global){var origDefine=global.define,get=function(e){var o,l=e.split("."),n=global;for(o=0;o<l.length&&n;o++)n=n[l[o]];return n},modules=global.define&&global.define.modules||{},ourDefine=global.define=function(e,o,l){var n;"function"==typeof o&&(l=o,o=[]);var t,i=[];for(t=0;t<o.length;t++)i.push(exports[o[t]]?get(exports[o[t]]):modules[o[t]]||get(o[t]));if(!o.length&&l.length){n={exports:{}};var r=function(e){return exports[e]?get(exports[e]):modules[e]};i.push(r,n.exports,n)}else i[0]||"exports"!==o[0]||(n={exports:{}},i[0]=n.exports,"module"===o[1]&&(i[1]=n));global.define=origDefine;var f=l?l.apply(null,i):void 0;global.define=ourDefine,modules[e]=n&&n.exports?n.exports:f};global.define.modules=modules,global.define.amd=!0,global.System={define:function(__name,__code){global.define=origDefine,eval("(function() { "+__code+" \n }).call(global);"),global.define=ourDefine}}}({},window);
/*gazel@1.0.0#slice*/
define("gazel/slice",["exports","module"],function(e,t){"use strict";t.exports=Array.prototype.slice});
/*gazel@1.0.0#print*/
define("gazel/print",["exports","gazel/slice"],function(e,r){"use strict";function n(){var e=a.call(arguments);0!==e.length&&(Array.isArray(e[0])?e[0]:[e[0]]).forEach(function(e){console.log(e)})}var t=function(e){return e&&e.__esModule?e["default"]:e};e.print=n;var a=t(r);Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#decr*/
define("gazel/decr",["exports"],function(e){"use strict";function r(e,r,n){return this.incrby(e,-r,n)}function n(e,r){return this.incrby(e,-1,r)}e.decrby=r,e.decr=n,Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#dbfunctions*/
define("gazel/dbfunctions",["exports"],function(e){"use strict";function o(e,r,a){if(n&&n.version==gazel.version&&n.name===gazel.dbName)return void e(n);if(t)return void setTimeout(function(){o(e,r)},100);t=!0;var i=window.indexedDB.open(gazel.dbName,gazel.version);i.onupgradeneeded=function(e){var o=e.target.result;o.objectStoreNames.contains(gazel.osName)||o.createObjectStore(gazel.osName),a&&a(o)};var s;s=i.onsuccess=function(o){var a=o.target.result;if(a.setVersion&&Number(a.version)!==gazel.version){n&&n.close();var c=a.setVersion(String(gazel.version));return c.onsuccess=function(e){var o={};o.target={},o.target.result=e.target.result.db,i.onupgradeneeded(o),s(o)},c.onerror=r,c.onfailure=r,void(c.onblocked=r)}n=a,t=!1,e(n)},i.onerror=function(n){return n&&12===n.target.errorCode?(gazel.version++,void o(e,r,a)):void r(n)},i.onblocked=r}function r(e,n,t){o(function(o){return o.objectStoreNames.contains(e)?void n():(o.close(),gazel.version++,void r(e,n,t))},t,function(o){o.objectStoreNames.contains(e)||o.createObjectStore(e)})}e.openDatabase=o,e.ensureObjectStore=r;var n,t=!1;Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#del*/
define("gazel/del",["exports","gazel/slice","gazel/dbfunctions"],function(e,t,n){"use strict";function r(){var e=i.call(arguments),t=e[e.length>0?e.length-1:0];return"function"!=typeof t?t=void 0:e.splice(e.length-1),this.register("write",this._del(e),t),this}function l(e){var t=this,n=e.length;return function(r,l){a(function(o){for(var i=t.trans.pull(o,t.osName,r,IDBTransaction.READ_WRITE),a=i.objectStore(t.osName),s=e.length,u=function(){var r=e.shift(),o=a["delete"](r);o.onerror=t.handleError.bind(t),o.onsuccess=function(){s--,t.emit("delete",r),0===s&&l.call(t,n)}};e.length>0;)u()})}}var o=function(e){return e&&e.__esModule?e["default"]:e};e.del=r,e._del=l;var i=o(t),a=n.openDatabase;Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#discard*/
define("gazel/discard",["exports"],function(t){"use strict";function e(t){try{this.trans.abortAll(),(t||function(){})("OK")}catch(e){this.handleError(e)}}t.discard=e,Object.defineProperty(t,"__esModule",{value:!0})});
/*gazel@1.0.0#error*/
define("gazel/error",["exports","gazel/slice"],function(e,r){"use strict";function t(){var e=["error"].concat(n.call(arguments));this.emit.apply(this,e)}var a=function(e){return e&&e.__esModule?e["default"]:e};e.handleError=t;var n=a(r);Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#get*/
define("gazel/get",["exports","gazel/dbfunctions"],function(e,t){"use strict";function r(e,t){var r=this;return this.register("read",function(t,o){n(function(n){var a=r.trans.pull(n,r.osName,t,IDBTransaction.READ_ONLY),s=a.objectStore(r.osName).get(e);s.onerror=r.handleError.bind(r),s.onsuccess=function(e){o.call(r,e.target.result)}},r.handleError.bind(r))},t),this}e.get=r;var n=t.openDatabase;Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#exists*/
define("gazel/exists",["exports","module"],function(e,n){"use strict";n.exports=function(e){return"undefined"!=typeof e&&null!=e}});
/*gazel@1.0.0#is_int*/
define("gazel/is_int",["exports","module"],function(e,t){"use strict";t.exports=function(e){return!isNaN(e)&&e%1===0}});
/*gazel@1.0.0#incr*/
define("gazel/incr",["exports","gazel/exists","gazel/is_int","gazel/dbfunctions"],function(e,r,n,t){"use strict";function i(e,r,n){var t=this;return this.register("write",function(n,i){c(function(o){var a=t.trans.pull(o,t.osName,n,IDBTransaction.READ_WRITE),c=a.objectStore(t.osName);!function l(n){var o;if(!s(n))return o=c.get(e),o.onerror=t.handleError.bind(t),void(o.onsuccess=function(e){l("undefined"==typeof e.target.result?0:e.target.result)});if(!u(n))return t.handleError("ERROR: Cannot increment a non-integer value.");var a=n+r;o=c.put(a,e),o.onerror=t.handleError.bind(t),o.onsuccess=function(r){var n=r.target.result===e?a:"ERR";t.emit("set",e,a),i.call(t,n)}}()},t.handleError.bind(t))},n),this}function o(e,r){return this.incrby(e,1,r)}var a=function(e){return e&&e.__esModule?e["default"]:e};e.incrby=i,e.incr=o;var s=a(r),u=a(n),c=t.openDatabase;Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#set*/
define("gazel/set",["exports","gazel/dbfunctions"],function(e,t){"use strict";function r(e,t,r){return this.register("write",this._set(e,t),r),this}function n(e,t){var r=this;return function(n,o){s(function(s){var i=r.trans.pull(s,r.osName,n,IDBTransaction.READ_WRITE),a=i.objectStore(r.osName).put(t,e);a.onerror=r.handleError.bind(r),a.onsuccess=function(n){var s=n.target.result===e?"OK":"ERR";r.emit("set",e,t),o.call(r,s)}},r.handleError.bind(r))}}e.set=r,e._set=n;var s=t.openDatabase;Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#dict*/
define("gazel/dict",["exports","module"],function(t,e){"use strict";var r=function(t,e,r){e&&Object.defineProperties(t,e),r&&Object.defineProperties(t.prototype,r)},n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(){n(this,t),this.items={}}return r(t,null,{prop:{value:function(t){return":"+t},writable:!0,configurable:!0},get:{value:function(t,e){var r=this.prop(t),n=this.items;return n.hasOwnProperty(r)?n[r]:e},writable:!0,configurable:!0},set:{value:function(t,e){var r=this.prop(t);return this.items[r]=e,e},writable:!0,configurable:!0},count:{value:function(){return Object.keys(this.items).length},writable:!0,configurable:!0},has:{value:function(t){var e=this.prop(t);return this.items.hasOwnProperty(e)},writable:!0,configurable:!0},del:{value:function(t){var e=this.prop(t),r=this.items;r.hasOwnProperty(e)&&delete r[e]},writable:!0,configurable:!0},keys:{value:function(){return Object.keys(this.items).map(function(t){return t.substring(1)})},writable:!0,configurable:!0}}),t}();e.exports=i});
/*gazel@1.0.0#uuid*/
define("gazel/uuid",["exports"],function(e){"use strict";function t(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}e.createUuid=t,Object.defineProperty(e,"__esModule",{value:!0})});
/*gazel@1.0.0#trans*/
define("gazel/trans",["exports","module","gazel/dict","gazel/uuid"],function(e,t,r,n){"use strict";var o=function(e){return e&&e.__esModule?e["default"]:e},i=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},u=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=o(r),c=n.createUuid,f=function(e){function t(){a(this,t),null!=e&&e.apply(this,arguments)}return u(t,e),i(t,null,{add:{value:function(){var e=c();return this.set(e,void 0),e},writable:!0,configurable:!0},abortAll:{value:function(){var e=this,t=e.keys();t.forEach(function(t){var r=e.get(t);r&&r.abort(),e.del(t)})},writable:!0,configurable:!0},pull:{value:function(e,t,r,n){var o=this.get(r);return o||(o=e.transaction([t],n),o.onerror=onerror,this.set(r,o)),o},writable:!0,configurable:!0}}),t}(l);t.exports=f});
/*gazel@1.0.0#client*/
define("gazel/client",["exports","module","gazel/decr","gazel/del","gazel/discard","gazel/error","gazel/get","gazel/incr","gazel/set","gazel/dict","gazel/trans","gazel/dbfunctions","gazel/slice"],function(t,e,i,n,s,r,a,h,l,c,u,d,o){"use strict";function f(){this.chain=[],this.inMulti=!1,this.returned=[],this.trans=new V,this.transMap=new O,this.events=new O}var g=function(t){return t&&t.__esModule?t["default"]:t},v=i.decr,p=i.decrby,z=n.del,m=n._del,M=s.discard,y=r.handleError,b=a.get,_=h.incr,E=h.incrby,w=l.set,x=l._set,O=g(c),V=g(u),j=d.ensureObjectStore,k=g(o);e.exports=f;var N=f.prototype={register:function(t,e,i){var n,s=this;return this.needsOsVerification?void j(this.osName,function(){s.needsOsVerification=!1,s.register(t,e,i)},this.handleError.bind(this)):this.inMulti?(n=this.transMap.get(t),n||(n=this.trans.add(),this.transMap.set(t,n)),void this.chain.push({uuid:n,action:e})):(n=s.trans.add(),void e(n,function(){var t=k.call(arguments);s.trans.del(n),(i||function(){}).apply(null,t)}))},flush:function(){var t=k.call(arguments)||[];if(this.returned.push(t),0===this.chain.length)return void this.complete();var e=this.chain.shift();e.action.call(this,e.uuid,this.flush)},multi:function(){return this.chain=[],this.inMulti=!0,this},exec:function(t){this.inMulti=!1,this.complete=function(){var e=this,i=this.returned;this.complete=null,this.chain=null,this.returned=[],this.transMap.keys().forEach(function(t){var i=e.transMap.get(t);e.trans.del(i)}),this.transMap=new O,t(i)};var e=this.chain.shift();e.action.call(this,e.uuid,this.flush)},on:function(t,e){var i=this.events.get(t);i||(i=[],this.events.set(t,i)),i.push(e)},off:function(t,e){if(!e)return void this.events.del(t);var i=this.events.get(t);i.splice(i.indexOf(e),1)},emit:function(t){var e=k.call(arguments,1),i=this;setTimeout(function(){(i.events.get(t)||[]).forEach(function(t){t.apply(null,e)})})}};N.decr=v,N.decrby=p,N.del=z,N._del=m,N.discard=M,N.handleError=y,N.get=b,N.incr=_,N.incrby=E,N.set=w,N._set=x});
/*gazel@1.0.0#polyfill*/
define("gazel/polyfill",function(){"format cjs";window.indexedDB=window.indexedDB||window.mozIndexedDB||window.msIndexedDB||window.webkitIndexedDB||window.oIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,window.IDBTransaction.READ_ONLY=window.IDBTransaction.READ_ONLY||"readonly",window.IDBTransaction.READ_WRITE=window.IDBTransaction.READ_WRITE||"readwrite"});
/*gazel@1.0.0#gazel*/
define("gazel",["exports","gazel/print","gazel/client","gazel/exists","gazel/polyfill"],function(e,n,t,a){"use strict";var o=function(e){return e&&e.__esModule?e["default"]:e},i=(n.print,o(t)),l=o(a),r={};r.dbName="gazeldb",r.osName="gazelos";var s="_gazel.version",c=localStorage[s]&&0|localStorage[s]||1;Object.defineProperty(r,"version",{get:function(){return c},set:function(e){c=e,localStorage[s]=e}}),r.compatible=l(window.indexedDB)&&l(window.IDBTransaction),r.createClient=function(e){var n=new i;return n.osName=e||r.osName,e&&(n.needsOsVerification=!0),n},window.gazel=r,e["default"]=r,Object.defineProperty(e,"__esModule",{value:!0})});
